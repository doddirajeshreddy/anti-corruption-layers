apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-api-seed
  namespace: app
data:
  seeder.sql: |
    CREATE TABLE IF NOT EXISTS users (
      id SERIAL PRIMARY KEY,
      username VARCHAR(255) NOT NULL,
      email VARCHAR(255) NOT NULL UNIQUE,
      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    );

    INSERT INTO users (username, email)
    VALUES ('rajesh', 'rajesh@gmail.com'),
           ('revanth', 'revanth@gmail.com'),
           ('harish', 'harish@gmail.com');
    ON CONFLICT (email_address) DO NOTHING;
